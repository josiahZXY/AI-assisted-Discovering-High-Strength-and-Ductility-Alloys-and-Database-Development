import requests
import openpyxl
from lxml import etree
from copy import deepcopy


def write_excel_xlsx(path, sheet_name, value):
	index = len(value)
	workbook = openpyxl.Workbook()
	sheet = workbook.active
	sheet.title = sheet_name
	for i in range(0, index):
		for j in range(0, len(value[i])):
			sheet.cell(row=i + 1, column=j + 1, value=str(value[i][j]))
	workbook.save(path)
	print("xlsx格式表格写入数据成功！")

def read_excel_xlsx(path, sheet_name):
	workbook = openpyxl.load_workbook(path)
	# sheet = wb.get_sheet_by_name(sheet_name)这种方式已经弃用，不建议使用
	sheet = workbook[sheet_name]
	for row in sheet.rows:
		for cell in row:
			print(cell.value, "\t", end="")

def save_data(excel_name, data_list):
	book_name_xlsx = excel_name + '.xlsx'
	
	sheet_name_xlsx = 'matweb数据'
	# # save_data([[title, types, name, metric, english, comments]], '结果集')
	excel_title = ["title", "types", "name", "metric","english","comments"]
	write_data = deepcopy(data_list)
	write_data.insert(0, excel_title)
	write_excel_xlsx(book_name_xlsx, sheet_name_xlsx, write_data)
	read_excel_xlsx(book_name_xlsx, sheet_name_xlsx)

def detaile_spider(data_list):
	print(data_list)
	detaile_headers = {'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3',
	'Accept-Encoding':'gzip, deflate',
	'Accept-Language': 'en-GB,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7,zh;q=0.6',
	'Cache-Control': 'max-age=0',
	'Connection': 'keep-alive',
	'Cookie': 'matweb5=%2bUJPzF1I2OU%3d=%2bRMOokPN1rM%3d&LanguageID=1&CookieID=98ff67d4ba2042b69c9707d8f8672d9f&SearchResultsPerPage=50; __utmz=15208169.1580816734.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); ASP.NET_SessionId=wfkcs255nc0h1t3k3s1loh45; __utmc=15208169; __utma=15208169.1785664677.1580816734.1580883671.1580893523.5; __utmt=1; __utmb=15208169.1.10.1580893523',
	'Host': 'www.matweb.com',
	'Referer': 'http://www.matweb.com/search/PropertySearch.aspx',
	'Upgrade-Insecure-Requests': '1',
	'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36'}
	result_data = []
	for i in data_list:
		title = i[0]
		detaile_url = i[1]
		res = requests.get(url=detaile_url , headers=detaile_headers)
		html = etree.HTML(res.text)
		mechanical_properties = []
		trs = html.xpath('//th[text()="Mechanical Properties"]/ancestor::tr/following-sibling::tr')
		for tr in trs:
			if tr.xpath('./@class'):
				mechanical_properties.append(tr)
			else:
				break
		component_elements_properties = []
		trs = html.xpath('//th[text()="Component Elements Properties"]/ancestor::tr/following-sibling::tr')
		for tr in trs:
			if tr.xpath('./@class'):
				component_elements_properties.append(tr)
			else:
				break
		for i in mechanical_properties:
			types = 'Mechanical Properties'
			name = ''.join(i.xpath('./td[1]//text()')).strip()
			metric = ''.join(i.xpath('./td[2]//text()')).strip()
			english = ''.join(i.xpath('./td[3]//text()')).strip()
			comments = ''.join(i.xpath('./td[4]//text()')).strip()
			result_data.append([title, types, name, metric, english, comments])
		for i in component_elements_properties:
			types = 'Component Elements Properties'
			name = ''.join(i.xpath('./td[1]//text()')).strip()
			metric = ''.join(i.xpath('./td[2]//text()')).strip()
			english = ''.join(i.xpath('./td[3]//text()')).strip()
			comments = ''.join(i.xpath('./td[4]//text()')).strip()
			result_data.append([title, types, name, metric, english, comments])
		# print(result_data)
		print('-----------------')
	save_data('结果集',result_data)

def start_spider():
	url2 = 'http://www.matweb.com/search/PropertySearch.aspx'
	headers = {
		'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3',
		'Accept-Encoding': 'gzip, deflate',
		'Accept-Language': 'en-GB,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7,zh;q=0.6',
		'Cache-Control': 'max-age=0',
		'Connection': 'keep-alive',
		'Content-Length': '28444',
		'Content-Type': 'application/x-www-form-urlencoded',
		'Cookie': '__utmz=15208169.1580816734.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); ASP.NET_SessionId=wfkcs255nc0h1t3k3s1loh45; __utmc=15208169; matweb5=%2bUJPzF1I2OU%3d=%2bRMOokPN1rM%3d&LanguageID=1&CookieID=98ff67d4ba2042b69c9707d8f8672d9f&SearchResultsPerPage=200; __utma=15208169.1785664677.1580816734.1580900951.1580960460.7; __utmb=15208169.5.10.1580960460',
		'Host': 'www.matweb.com',
		'Origin': 'http://www.matweb.com',
		'Referer': 'http://www.matweb.com/search/PropertySearch.aspx',
		'Upgrade-Insecure-Requests': '1',
		'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36'}
	data_list = []
	
	for i in range(1,3):
		data = {'__EVENTTARGET': 'ctl00$ContentMain$UcSearchResults1$lnkNextPage2',
				'__EVENTARGUMENT': '',
				'__LASTFOCUS': '',
				'ctl00_ContentMain_ucMatGroupTree_LODCS1_msTreeView_ExpandState': 'ccccccnc',
				'ctl00_ContentMain_ucMatGroupTree_LODCS1_msTreeView_SelectedNode': '',
				'ctl00_ContentMain_ucMatGroupTree_LODCS1_msTreeView_PopulateLog': '',
				# '__VIEWSTATE': '/wEPDwUKLTI1OTk4MjM2NQ9kFgJmD2QWAgIBD2QWKgIBD2QWAmYPFgIeBFRleHQFZ0RhdGEgc2hlZXRzIGZvciBvdmVyIDxzcGFuIGNsYXNzPSJncmVldGluZyI+MTM1LDAwMDwvc3Bhbj4gIG1ldGFscywgcGxhc3RpY3MsIGNlcmFtaWNzLCBhbmQgY29tcG9zaXRlcy5kAgIPZBYCZg8WAh8ABQRIT01FZAIDD2QWAmYPFgIfAAUGU0VBUkNIZAIED2QWAmYPFgIfAAUFVE9PTFNkAgUPZBYCZg8WAh8ABQlTVVBQTElFUlNkAgYPZBYCZg8WAh8ABQdGT0xERVJTZAIHD2QWAmYPFgIfAAUIQUJPVVQgVVNkAggPZBYCZg8WAh8ABQNGQVFkAgkPZBYCZg8WAh8ABQdBQ0NPVU5UZAIKD2QWAmYPFgIfAAUGTE9HIElOZAILDxBkZBYBZmQCDA9kFgJmDxYCHwAFCFNlYXJjaGVzZAIND2QWAmYPFgIfAAUIQWR2YW5jZWRkAg4PZBYCZg8WAh8ABQhDYXRlZ29yeWQCDw9kFgJmDxYCHwAFCFByb3BlcnR5ZAIQD2QWAmYPFgIfAAUGTWV0YWxzZAIRD2QWAmYPFgIfAAUKVHJhZGUgTmFtZWQCEg9kFgJmDxYCHwAFDE1hbnVmYWN0dXJlcmQCEw9kFgICAQ9kFgJmDxYCHwAFGVJlY2VudGx5IFZpZXdlZCBNYXRlcmlhbHNkAhUPZBYQAgIPZBYCZg8WAh8ABZgBPGEgaHJlZj0iL2NsaWNrdGhyb3VnaC5hc3B4P2FkZGF0YWlkPTE0NjciPjxpbWcgc3JjPSIvaW1hZ2VzL2Fzc2V0cy9lbnNpbmdlcl9wb2x5bWVyczIwMTguZ2lmIiB3aWR0aCA9IDcyOCBoZWlnaHQgPSA5MCAgYm9yZGVyPTAgYWx0PSJFbnNpbmdlciBQRUkiPjwvYT5kAgMPZBYCAgIPFgIeBXN0eWxlBRlkaXNwbGF5Om5vbmU7d2lkdGg6MjUwcHg7FgYCAQ9kFgJmD2QWAmYPDxYCHwAFEkRhdGEgSW5wdXQgUHJvYmxlbWRkAgMPDxYCHwBlZGQCBQ8WAh4FdmFsdWUFAk9LZAIFDw8WBB4IQ2xpZW50SUQCAR4KTGFuZ3VhZ2VJRAIBZBYCZg8UKwAJDxYOHhdQb3B1bGF0ZU5vZGVzRnJvbUNsaWVudGceEkVuYWJsZUNsaWVudFNjcmlwdGceCVNob3dMaW5lc2ceCE5vZGVXcmFwZx4NTmV2ZXJFeHBhbmRlZGQeDFNlbGVjdGVkTm9kZWQeCUxhc3RJbmRleAIIZBYIHgtOb2RlU3BhY2luZxsAAAAAAAAAAAEAAAAeCUZvcmVDb2xvcgojHhFIb3Jpem9udGFsUGFkZGluZxsAAAAAAAAIQAEAAAAeBF8hU0IChIAYZGRkZGRkFCsACQUjMjowLDA6MCwwOjEsMDoyLDA6MywwOjQsMDo1LDA6NiwwOjcUKwACFgwfAAUSQ2FyYm9uICg4NjYgbWF0bHMpHgVWYWx1ZQUDMjgzHghFeHBhbmRlZGgeDFNlbGVjdEFjdGlvbgsqLlN5c3RlbS5XZWIuVUkuV2ViQ29udHJvbHMuVHJlZU5vZGVTZWxlY3RBY3Rpb24CHgtOYXZpZ2F0ZVVybAU3amF2YXNjcmlwdDpNYXRHcm91cFNlbGVjdGVkKCdDYXJib24gKDg2NiBtYXRscyknLCcyODMnKR4QUG9wdWxhdGVPbkRlbWFuZGdkFCsAAhYMHwAFFUNlcmFtaWMgKDEwMDA0IG1hdGxzKR8QBQIxMR8RaB8SCysEAh8TBTlqYXZhc2NyaXB0Ok1hdEdyb3VwU2VsZWN0ZWQoJ0NlcmFtaWMgKDEwMDA0IG1hdGxzKScsJzExJykfFGdkFCsAAhYMHwAFEkZsdWlkICg3NTYyIG1hdGxzKR8QBQE1HxFoHxILKwQCHxMFNWphdmFzY3JpcHQ6TWF0R3JvdXBTZWxlY3RlZCgnRmx1aWQgKDc1NjIgbWF0bHMpJywnNScpHxRnZBQrAAIWDB8ABRNNZXRhbCAoMTcwNTIgbWF0bHMpHxAFATkfEWgfEgsrBAIfEwU2amF2YXNjcmlwdDpNYXRHcm91cFNlbGVjdGVkKCdNZXRhbCAoMTcwNTIgbWF0bHMpJywnOScpHxRnZBQrAAIWDB8ABSdPdGhlciBFbmdpbmVlcmluZyBNYXRlcmlhbCAoODA2MyBtYXRscykfEAUDMjg1HxFoHxILKwQCHxMFTGphdmFzY3JpcHQ6TWF0R3JvdXBTZWxlY3RlZCgnT3RoZXIgRW5naW5lZXJpbmcgTWF0ZXJpYWwgKDgwNjMgbWF0bHMpJywnMjg1JykfFGdkFCsAAhYMHwAFFVBvbHltZXIgKDk3NjM1IG1hdGxzKR8QBQIxMB8RaB8SCysEAh8TBTlqYXZhc2NyaXB0Ok1hdEdyb3VwU2VsZWN0ZWQoJ1BvbHltZXIgKDk3NjM1IG1hdGxzKScsJzEwJykfFGdkFCsAAhYMHwAFGFB1cmUgRWxlbWVudCAoNTA3IG1hdGxzKR8QBQMxODQfEWgfEgsrBAIfEwU9amF2YXNjcmlwdDpNYXRHcm91cFNlbGVjdGVkKCdQdXJlIEVsZW1lbnQgKDUwNyBtYXRscyknLCcxODQnKR8UaGQUKwACFgwfAAUlV29vZCBhbmQgTmF0dXJhbCBQcm9kdWN0cyAoMzk4IG1hdGxzKR8QBQMyNzcfEWgfEgsrBAIfEwVKamF2YXNjcmlwdDpNYXRHcm91cFNlbGVjdGVkKCdXb29kIGFuZCBOYXR1cmFsIFByb2R1Y3RzICgzOTggbWF0bHMpJywnMjc3JykfFGdkZAIGDxYCHglpbm5lcmh0bWwFE01ldGFsICgxNzA1MiBtYXRscylkAgsPZBYCZg9kFgQCAQ9kFgJmDxAPZBYCHghvbmNoYW5nZQVJX19kb1Bvc3RCYWNrKCJjdGwwMF9Db250ZW50TWFpbl91Y1Byb3BlcnR5RHJvcGRvd24xX2RycFByb3BlcnR5TGlzdCIsIiIpOxAVcg4gLS0gc2VsZWN0IC0tIB0xJSBTZWNhbnQgTW9kdWx1cyAoNTQ2IG1hdGxzKSIxJSBTZWNhbnQgTW9kdWx1cywgTUQgKDE5NTMgbWF0bHMpIjElIFNlY2FudCBNb2R1bHVzLCBURCAoMTkxNyBtYXRscykdMiUgU2VjYW50IE1vZHVsdXMgKDU0NiBtYXRscykbQXJjIFJlc2lzdGFuY2UgKDMyNjggbWF0bHMpGkNoYXJweSBJbXBhY3QgKDEwNTUgbWF0bHMpJUNoYXJweSBJbXBhY3QgVW5ub3RjaGVkICgxMTkyNSBtYXRscykkQ2hhcnB5IEltcGFjdCwgTm90Y2hlZCAoMTYxODYgbWF0bHMpJENvZWZmaWNpZW50IG9mIEZyaWN0aW9uICgzNDgwIG1hdGxzKSdDb21wYXJhdGl2ZSBUcmFja2luZyBJbmRleCAoOTA5NiBtYXRscykgQ29tcHJlc3NpdmUgTW9kdWx1cyAoMTg5MiBtYXRscyknQ29tcHJlc3NpdmUgWWllbGQgU3RyZW5ndGggKDg2MjAgbWF0bHMpGUNURSwgbGluZWFyICgyOTQ3NiBtYXRscyksQ1RFLCBsaW5lYXIsIFRyYW5zdmVyc2UgdG8gRmxvdyAoNzA2NCBtYXRscykWQ3VyZSBUaW1lICg0MTEwIG1hdGxzKTlEZWZsZWN0aW9uIFRlbXBlcmF0dXJlIGF0IDAuNDYgTVBhICg2NiBwc2kpICgyNDE2OSBtYXRscyk5RGVmbGVjdGlvbiBUZW1wZXJhdHVyZSBhdCAxLjggTVBhICgyNjQgcHNpKSAoMzU3ODYgbWF0bHMpK0RlZmxlY3Rpb24gVGVtcGVyYXR1cmUgYXQgNS4wIE1QYSAoMCBtYXRscyktRGVmbGVjdGlvbiBUZW1wZXJhdHVyZSBhdCA4LjAgTVBhICg4OTUgbWF0bHMpFkRlbnNpdHkgKDEwODIyNyBtYXRscykhRGllbGVjdHJpYyBDb25zdGFudCAoMTM0NjMgbWF0bHMpIURpZWxlY3RyaWMgU3RyZW5ndGggKDE1OTIwIG1hdGxzKSBEaXNzaXBhdGlvbiBGYWN0b3IgKDEwNjAxIG1hdGxzKSBEcnlpbmcgVGVtcGVyYXR1cmUgKDE5MzkxIG1hdGxzKSRFbGVjdHJpY2FsIFJlc2lzdGl2aXR5ICgzMDQ0MCBtYXRscykbRUxPTkdBVElPTiBbUFJPUEVSVFkgR1JPVVBdIUVsb25nYXRpb24gYXQgQnJlYWsgKDcyMzQ2IG1hdGxzKSFFbG9uZ2F0aW9uIGF0IFlpZWxkICgxNDQ1MyBtYXRscykcRW1pc3Npdml0eSAoMC0xKSAoMTYyIG1hdGxzKR1GYXRpZ3VlIFN0cmVuZ3RoICgxMTY2IG1hdGxzKSlGaWxtIEVsb25nYXRpb24gYXQgQnJlYWssIE1EICgzNjA0IG1hdGxzKSlGaWxtIEVsb25nYXRpb24gYXQgQnJlYWssIFREICgzMzYxIG1hdGxzKShGaWxtIEVsb25nYXRpb24gYXQgWWllbGQsIE1EICgyOTggbWF0bHMpKEZpbG0gRWxvbmdhdGlvbiBhdCBZaWVsZCwgVEQgKDI1NSBtYXRscykvRmlsbSBUZW5zaWxlIFN0cmVuZ3RoIGF0IEJyZWFrLCBNRCAoMzc3NSBtYXRscykvRmlsbSBUZW5zaWxlIFN0cmVuZ3RoIGF0IEJyZWFrLCBURCAoMzUyMiBtYXRscykvRmlsbSBUZW5zaWxlIFN0cmVuZ3RoIGF0IFlpZWxkLCBNRCAoMTY1OSBtYXRscykvRmlsbSBUZW5zaWxlIFN0cmVuZ3RoIGF0IFlpZWxkLCBURCAoMTYzMSBtYXRscykgRmxhbW1hYmlsaXR5LCBVTDk0ICgyNTMzMiBtYXRscykeRmxleHVyYWwgTW9kdWx1cyAoNDU5MDEgbWF0bHMpIEZsZXh1cmFsIFN0aWZmbmVzcyAoNDU5MDEgbWF0bHMpJUZsZXh1cmFsIFlpZWxkIFN0cmVuZ3RoICgzNzMxOCBtYXRscykeRnJhY3R1cmUgVG91Z2huZXNzICg2MDggbWF0bHMpG0dhcmRuZXIgSW1wYWN0ICgxNTc4IG1hdGxzKSZHbGFzcyBUcmFuc2l0aW9uIFRlbXAsIFRnICg1ODY0IG1hdGxzKRJHbG9zcyAoMzE5MCBtYXRscykbR2xvdyBXaXJlIFRlc3QgKDM5NTkgbWF0bHMpHEhhcmRuZXNzLCBCYXJjb2wgKDQ5NSBtYXRscykeSGFyZG5lc3MsIEJyaW5lbGwgKDQ3MjEgbWF0bHMpHEhhcmRuZXNzLCBLbm9vcCAoMzM3NCBtYXRscykgSGFyZG5lc3MsIFJvY2t3ZWxsIEEgKDY2NyBtYXRscykhSGFyZG5lc3MsIFJvY2t3ZWxsIEIgKDQxNTUgbWF0bHMpIUhhcmRuZXNzLCBSb2Nrd2VsbCBDICgzMjEwIG1hdGxzKSBIYXJkbmVzcywgUm9ja3dlbGwgRSAoMzIyIG1hdGxzKSFIYXJkbmVzcywgUm9ja3dlbGwgTSAoMzE3NSBtYXRscykhSGFyZG5lc3MsIFJvY2t3ZWxsIFIgKDk0ODkgbWF0bHMpH0hhcmRuZXNzLCBTaG9yZSBBICgxNzIwNSBtYXRscykfSGFyZG5lc3MsIFNob3JlIEQgKDExMDE1IG1hdGxzKR5IYXJkbmVzcywgVmlja2VycyAoNDEwNyBtYXRscykRSGF6ZSAoNTEwOCBtYXRscyknSGVhdCBEaXN0b3J0aW9uIFRlbXBlcmF0dXJlICgzNzcgbWF0bHMpG0hlYXQgb2YgRnVzaW9uICgxMDcwIG1hdGxzKSJIb3QgQmFsbCBQcmVzc3VyZSBUZXN0ICg4NTQgbWF0bHMpF0l6b2QgSW1wYWN0ICg2ODkgbWF0bHMpIkl6b2QgSW1wYWN0LCBOb3RjaGVkICgyOTQ1OSBtYXRscykkSXpvZCBJbXBhY3QsIFVubm90Y2hlZCAoMTAwMTIgbWF0bHMpG0sgKHdlYXIpIEZhY3RvciAoOTYxIG1hdGxzKSNMaW5lYXIgTW9sZCBTaHJpbmthZ2UgKDM0Njk2IG1hdGxzKRVMaXF1aWR1cyAoNTEyMSBtYXRscykhTWFnbmV0aWMgUGVybWVhYmlsaXR5ICg4OTggbWF0bHMpLk1heGltdW0gU2VydmljZSBUZW1wZXJhdHVyZSwgQWlyICgyMDE3NCBtYXRscykuTWF4aW11bSBTZXJ2aWNlIFRlbXBlcmF0dXJlLCBJbmVydCAoMzYwIG1hdGxzKRdNZWx0IEZsb3cgKDMyNzI1IG1hdGxzKR5NZWx0IFRlbXBlcmF0dXJlICgyNzU0MiBtYXRscykbTWVsdGluZyBQb2ludCAoMjcyMzAgbWF0bHMpLk1pbmltdW0gU2VydmljZSBUZW1wZXJhdHVyZSwgQWlyICgxMDA1OCBtYXRscykYTU9EVUxVUyBbUFJPUEVSVFkgR1JPVVBdI01vZHVsdXMgb2YgRWxhc3RpY2l0eSAoNDEyNTAgbWF0bHMpL01vaXN0dXJlIEFic29ycHRpb24gYXQgRXF1aWxpYnJpdW0gKDk5MTEgbWF0bHMpJ01vaXN0dXJlIFZhcG9yIFRyYW5zbWlzc2lvbiAoMzQ0IG1hdGxzKR5Nb2xkIFRlbXBlcmF0dXJlICgyNTU4MyBtYXRscykZT3h5Z2VuIEluZGV4ICg1MDUwIG1hdGxzKR9PeHlnZW4gVHJhbnNtaXNzaW9uICg1ODUgbWF0bHMpG1BvaXNzb25zIFJhdGlvICg3ODgzIG1hdGxzKSRQcm9jZXNzaW5nIFRlbXBlcmF0dXJlICgxMTM0MyBtYXRscykxUmVmbGVjdGlvbiBDb2VmZmljaWVudCwgVmlzaWJsZSAoMC0xKSAoMjYwIG1hdGxzKR1SZWZyYWN0aXZlIEluZGV4ICg0NzA0IG1hdGxzKSdSaW5nICYgQmFsbCBTb2Z0ZW5pbmcgUG9pbnQgKDQzMCBtYXRscykbUnVwdHVyZSBTdHJlbmd0aCAoMTggbWF0bHMpGlNlY2FudCBNb2R1bHVzICg1NDYgbWF0bHMpJFNFUlZJQ0UgVEVNUEVSQVRVUkUgW1BST1BFUlRZIEdST1VQXRpTaGVhciBNb2R1bHVzICg3Nzg0IG1hdGxzKRtTaGVhciBTdHJlbmd0aCAoNDc1NyBtYXRscykUU29saWR1cyAoNDg1NCBtYXRscykjU3BlY2lmaWMgSGVhdCBDYXBhY2l0eSAoOTc3NyBtYXRscykfU3RpZmZuZXNzIE1vZHVsdXMgKDQ1OTAxIG1hdGxzKRlTVFJFTkdUSCBbUFJPUEVSVFkgR1JPVVBdIFN1cmZhY2UgUmVzaXN0YW5jZSAoMTIxMjggbWF0bHMpGlRhY2stRnJlZSBUaW1lICg1MTAgbWF0bHMpGlRlYXIgU3RyZW5ndGggKDkxNTEgbWF0bHMpHVRlbnNpbGUgTW9kdWx1cyAoNDEyNTAgbWF0bHMpJ1RlbnNpbGUgU3RyZW5ndGggYXQgQnJlYWsgKDY2NDMwIG1hdGxzKShUZW5zaWxlIFN0cmVuZ3RoLCBVbHRpbWF0ZSAoNjY0MzAgbWF0bHMpJVRlbnNpbGUgU3RyZW5ndGgsIFlpZWxkICg0NjIzOCBtYXRscykiVGhlcm1hbCBDb25kdWN0aXZpdHkgKDE2NzU1IG1hdGxzKSJUcmFuc21pc3Npb24sIFZpc2libGUgKDYzNzcgbWF0bHMpH1VMIFJUSSwgRWxlY3RyaWNhbCAoMzI4NyBtYXRscykrVUwgUlRJLCBNZWNoYW5pY2FsIHdpdGggSW1wYWN0ICgyOTg5IG1hdGxzKS5VTCBSVEksIE1lY2hhbmljYWwgd2l0aG91dCBJbXBhY3QgKDMwMDIgbWF0bHMpI1ZpY2F0IFNvZnRlbmluZyBQb2ludCAoMTc4MzkgbWF0bHMpHldhdGVyIEFic29ycHRpb24gKDE4NjM2IG1hdGxzKSFXQVRFUiBBQlNPUlBUSU9OIFtQUk9QRVJUWSBHUk9VUF0rV2F0ZXIgQWJzb3JwdGlvbiBhdCBTYXR1cmF0aW9uICg0MjYyIG1hdGxzKRVyATABMQEyATMBNQI1MQMxMjYDMTI3AzEyOAMxNTMDMTU2AzE1OQMxNjEDMTgyAzE4MwMxOTQDMjA5AzIxMAMyMTEDMjEyAzIxNQMyMjcDMjMwAzIzOAMyNDYDMjU0CEdST1VQXzE3AzI2MwMyNjUDMjY2AzI4OAMyOTkDMzAwAzMwMQMzMDIDMzAzAzMwNAMzMDUDMzA2AzMxMQMzMTQDMzE1AzMxNwMzMjkDMzM2AzM0MgMzNDQDMzQ1AzM1NAMzNTUDMzU4AzM2MgMzNjMDMzY0AzM2NQMzNzEDMzcyAzM3MwMzNzUDMzgwAzM4MgMzODUDMzg3AzQwMAM0MzkDNDQzAzQ1MAM0NTgDNDcyAzQ3NgM0OTADNDk4AzQ5OQM1MDEDNTAzAzUwNAM1MTcIR1JPVVBfMTUDNTE4AzUyMgM1MjUDNTI3AzU1OQM1NjEDNTk4AzYxOQM2MjcDNjI4AzYzMgM2MzUDNjQzCEdST1VQXzE4AzY0OAM2NTADNjg4AzY5NQM3MDcIR1JPVVBfMTYDNzIwBDExMzMDNzI5AzczOAM3NDIDNzQzAzc0NQM3NTEDNzY5Azc3NwM3NzgDNzc5Azc5MwM4MDcIR1JPVVBfMTQDODA4FCsDcmdnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZxYBAhtkAgMPDxYIHhNTZWxlY3RlZFByb3BHcm91cElEZh4OU2VsZWN0ZWRQcm9wSUQChwIfAwIBHwQCAWQWDmYPDxYCHgdWaXNpYmxlaGQWBAIBDw8WAh8ABRNTZWxlY3RlZCBQcm9wZXJ0eTogZGQCAw8PFgIfAAUhRWxvbmdhdGlvbiBhdCBCcmVhayAoNzIzNDYgbWF0bHMpZGQCBA8QZGQWAGQCCA8QZGQWAGQCCg8QDxYGHg1EYXRhVGV4dEZpZWxkBQdVT01UZXh0Hg5EYXRhVmFsdWVGaWVsZAUFVU9NSUQeC18hRGF0YUJvdW5kZ2QQFQEBJRUBAzEzNxQrAwFnFgFmZAIMDw8WAh8ABXZNaW46IDxhIGhyZWY9ImphdmFzY3JpcHQ6bWF0d2ViLnNldEZpZWxkVmFsdWUoJ2N0bDAwX0NvbnRlbnRNYWluX3VjUHJvcGVydHlFZGl0MV90eHRwTWluJywnMC4wMDAnKTsiPjAuMDAwPC9hPiAlJm5ic3A7ZGQCDg8PFgIfAAVuTWF4OiA8YSBocmVmPSJqYXZhc2NyaXB0Om1hdHdlYi5zZXRGaWVsZFZhbHVlKCdjdGwwMF9Db250ZW50TWFpbl91Y1Byb3BlcnR5RWRpdDFfdHh0cE1heCcsJzI2MDAnKTsiPjI2MDA8L2E+ICVkZAISD2QWBAIBDxBkEBUAFQAUKwMAFgBkAgMPZBYKAgEPDxYCHwAFATBkZAIDDw8WAh8AZWRkAgUPEGQQFQAVABQrAwAWAGQCCw8PFgIfGWhkZAINDxAPFgIeB0NoZWNrZWRoZGRkZAIMD2QWAmYPZBYEAgEPZBYCZg8QD2QWAh8WBUlfX2RvUG9zdEJhY2soImN0bDAwX0NvbnRlbnRNYWluX3VjUHJvcGVydHlEcm9wZG93bjJfZHJwUHJvcGVydHlMaXN0IiwiIik7EBVyDiAtLSBzZWxlY3QgLS0gHTElIFNlY2FudCBNb2R1bHVzICg1NDYgbWF0bHMpIjElIFNlY2FudCBNb2R1bHVzLCBNRCAoMTk1MyBtYXRscykiMSUgU2VjYW50IE1vZHVsdXMsIFREICgxOTE3IG1hdGxzKR0yJSBTZWNhbnQgTW9kdWx1cyAoNTQ2IG1hdGxzKRtBcmMgUmVzaXN0YW5jZSAoMzI2OCBtYXRscykaQ2hhcnB5IEltcGFjdCAoMTA1NSBtYXRscyklQ2hhcnB5IEltcGFjdCBVbm5vdGNoZWQgKDExOTI1IG1hdGxzKSRDaGFycHkgSW1wYWN0LCBOb3RjaGVkICgxNjE4NiBtYXRscykkQ29lZmZpY2llbnQgb2YgRnJpY3Rpb24gKDM0ODAgbWF0bHMpJ0NvbXBhcmF0aXZlIFRyYWNraW5nIEluZGV4ICg5MDk2IG1hdGxzKSBDb21wcmVzc2l2ZSBNb2R1bHVzICgxODkyIG1hdGxzKSdDb21wcmVzc2l2ZSBZaWVsZCBTdHJlbmd0aCAoODYyMCBtYXRscykZQ1RFLCBsaW5lYXIgKDI5NDc2IG1hdGxzKSxDVEUsIGxpbmVhciwgVHJhbnN2ZXJzZSB0byBGbG93ICg3MDY0IG1hdGxzKRZDdXJlIFRpbWUgKDQxMTAgbWF0bHMpOURlZmxlY3Rpb24gVGVtcGVyYXR1cmUgYXQgMC40NiBNUGEgKDY2IHBzaSkgKDI0MTY5IG1hdGxzKTlEZWZsZWN0aW9uIFRlbXBlcmF0dXJlIGF0IDEuOCBNUGEgKDI2NCBwc2kpICgzNTc4NiBtYXRscykrRGVmbGVjdGlvbiBUZW1wZXJhdHVyZSBhdCA1LjAgTVBhICgwIG1hdGxzKS1EZWZsZWN0aW9uIFRlbXBlcmF0dXJlIGF0IDguMCBNUGEgKDg5NSBtYXRscykWRGVuc2l0eSAoMTA4MjI3IG1hdGxzKSFEaWVsZWN0cmljIENvbnN0YW50ICgxMzQ2MyBtYXRscykhRGllbGVjdHJpYyBTdHJlbmd0aCAoMTU5MjAgbWF0bHMpIERpc3NpcGF0aW9uIEZhY3RvciAoMTA2MDEgbWF0bHMpIERyeWluZyBUZW1wZXJhdHVyZSAoMTkzOTEgbWF0bHMpJEVsZWN0cmljYWwgUmVzaXN0aXZpdHkgKDMwNDQwIG1hdGxzKRtFTE9OR0FUSU9OIFtQUk9QRVJUWSBHUk9VUF0hRWxvbmdhdGlvbiBhdCBCcmVhayAoNzIzNDYgbWF0bHMpIUVsb25nYXRpb24gYXQgWWllbGQgKDE0NDUzIG1hdGxzKRxFbWlzc2l2aXR5ICgwLTEpICgxNjIgbWF0bHMpHUZhdGlndWUgU3RyZW5ndGggKDExNjYgbWF0bHMpKUZpbG0gRWxvbmdhdGlvbiBhdCBCcmVhaywgTUQgKDM2MDQgbWF0bHMpKUZpbG0gRWxvbmdhdGlvbiBhdCBCcmVhaywgVEQgKDMzNjEgbWF0bHMpKEZpbG0gRWxvbmdhdGlvbiBhdCBZaWVsZCwgTUQgKDI5OCBtYXRscykoRmlsbSBFbG9uZ2F0aW9uIGF0IFlpZWxkLCBURCAoMjU1IG1hdGxzKS9GaWxtIFRlbnNpbGUgU3RyZW5ndGggYXQgQnJlYWssIE1EICgzNzc1IG1hdGxzKS9GaWxtIFRlbnNpbGUgU3RyZW5ndGggYXQgQnJlYWssIFREICgzNTIyIG1hdGxzKS9GaWxtIFRlbnNpbGUgU3RyZW5ndGggYXQgWWllbGQsIE1EICgxNjU5IG1hdGxzKS9GaWxtIFRlbnNpbGUgU3RyZW5ndGggYXQgWWllbGQsIFREICgxNjMxIG1hdGxzKSBGbGFtbWFiaWxpdHksIFVMOTQgKDI1MzMyIG1hdGxzKR5GbGV4dXJhbCBNb2R1bHVzICg0NTkwMSBtYXRscykgRmxleHVyYWwgU3RpZmZuZXNzICg0NTkwMSBtYXRscyklRmxleHVyYWwgWWllbGQgU3RyZW5ndGggKDM3MzE4IG1hdGxzKR5GcmFjdHVyZSBUb3VnaG5lc3MgKDYwOCBtYXRscykbR2FyZG5lciBJbXBhY3QgKDE1NzggbWF0bHMpJkdsYXNzIFRyYW5zaXRpb24gVGVtcCwgVGcgKDU4NjQgbWF0bHMpEkdsb3NzICgzMTkwIG1hdGxzKRtHbG93IFdpcmUgVGVzdCAoMzk1OSBtYXRscykcSGFyZG5lc3MsIEJhcmNvbCAoNDk1IG1hdGxzKR5IYXJkbmVzcywgQnJpbmVsbCAoNDcyMSBtYXRscykcSGFyZG5lc3MsIEtub29wICgzMzc0IG1hdGxzKSBIYXJkbmVzcywgUm9ja3dlbGwgQSAoNjY3IG1hdGxzKSFIYXJkbmVzcywgUm9ja3dlbGwgQiAoNDE1NSBtYXRscykhSGFyZG5lc3MsIFJvY2t3ZWxsIEMgKDMyMTAgbWF0bHMpIEhhcmRuZXNzLCBSb2Nrd2VsbCBFICgzMjIgbWF0bHMpIUhhcmRuZXNzLCBSb2Nrd2VsbCBNICgzMTc1IG1hdGxzKSFIYXJkbmVzcywgUm9ja3dlbGwgUiAoOTQ4OSBtYXRscykfSGFyZG5lc3MsIFNob3JlIEEgKDE3MjA1IG1hdGxzKR9IYXJkbmVzcywgU2hvcmUgRCAoMTEwMTUgbWF0bHMpHkhhcmRuZXNzLCBWaWNrZXJzICg0MTA3IG1hdGxzKRFIYXplICg1MTA4IG1hdGxzKSdIZWF0IERpc3RvcnRpb24gVGVtcGVyYXR1cmUgKDM3NyBtYXRscykbSGVhdCBvZiBGdXNpb24gKDEwNzAgbWF0bHMpIkhvdCBCYWxsIFByZXNzdXJlIFRlc3QgKDg1NCBtYXRscykXSXpvZCBJbXBhY3QgKDY4OSBtYXRscykiSXpvZCBJbXBhY3QsIE5vdGNoZWQgKDI5NDU5IG1hdGxzKSRJem9kIEltcGFjdCwgVW5ub3RjaGVkICgxMDAxMiBtYXRscykbSyAod2VhcikgRmFjdG9yICg5NjEgbWF0bHMpI0xpbmVhciBNb2xkIFNocmlua2FnZSAoMzQ2OTYgbWF0bHMpFUxpcXVpZHVzICg1MTIxIG1hdGxzKSFNYWduZXRpYyBQZXJtZWFiaWxpdHkgKDg5OCBtYXRscykuTWF4aW11bSBTZXJ2aWNlIFRlbXBlcmF0dXJlLCBBaXIgKDIwMTc0IG1hdGxzKS5NYXhpbXVtIFNlcnZpY2UgVGVtcGVyYXR1cmUsIEluZXJ0ICgzNjAgbWF0bHMpF01lbHQgRmxvdyAoMzI3MjUgbWF0bHMpHk1lbHQgVGVtcGVyYXR1cmUgKDI3NTQyIG1hdGxzKRtNZWx0aW5nIFBvaW50ICgyNzIzMCBtYXRscykuTWluaW11bSBTZXJ2aWNlIFRlbXBlcmF0dXJlLCBBaXIgKDEwMDU4IG1hdGxzKRhNT0RVTFVTIFtQUk9QRVJUWSBHUk9VUF0jTW9kdWx1cyBvZiBFbGFzdGljaXR5ICg0MTI1MCBtYXRscykvTW9pc3R1cmUgQWJzb3JwdGlvbiBhdCBFcXVpbGlicml1bSAoOTkxMSBtYXRscyknTW9pc3R1cmUgVmFwb3IgVHJhbnNtaXNzaW9uICgzNDQgbWF0bHMpHk1vbGQgVGVtcGVyYXR1cmUgKDI1NTgzIG1hdGxzKRlPeHlnZW4gSW5kZXggKDUwNTAgbWF0bHMpH094eWdlbiBUcmFuc21pc3Npb24gKDU4NSBtYXRscykbUG9pc3NvbnMgUmF0aW8gKDc4ODMgbWF0bHMpJFByb2Nlc3NpbmcgVGVtcGVyYXR1cmUgKDExMzQzIG1hdGxzKTFSZWZsZWN0aW9uIENvZWZmaWNpZW50LCBWaXNpYmxlICgwLTEpICgyNjAgbWF0bHMpHVJlZnJhY3RpdmUgSW5kZXggKDQ3MDQgbWF0bHMpJ1JpbmcgJiBCYWxsIFNvZnRlbmluZyBQb2ludCAoNDMwIG1hdGxzKRtSdXB0dXJlIFN0cmVuZ3RoICgxOCBtYXRscykaU2VjYW50IE1vZHVsdXMgKDU0NiBtYXRscykkU0VSVklDRSBURU1QRVJBVFVSRSBbUFJPUEVSVFkgR1JPVVBdGlNoZWFyIE1vZHVsdXMgKDc3ODQgbWF0bHMpG1NoZWFyIFN0cmVuZ3RoICg0NzU3IG1hdGxzKRRTb2xpZHVzICg0ODU0IG1hdGxzKSNTcGVjaWZpYyBIZWF0IENhcGFjaXR5ICg5Nzc3IG1hdGxzKR9TdGlmZm5lc3MgTW9kdWx1cyAoNDU5MDEgbWF0bHMpGVNUUkVOR1RIIFtQUk9QRVJUWSBHUk9VUF0gU3VyZmFjZSBSZXNpc3RhbmNlICgxMjEyOCBtYXRscykaVGFjay1GcmVlIFRpbWUgKDUxMCBtYXRscykaVGVhciBTdHJlbmd0aCAoOTE1MSBtYXRscykdVGVuc2lsZSBNb2R1bHVzICg0MTI1MCBtYXRscyknVGVuc2lsZSBTdHJlbmd0aCBhdCBCcmVhayAoNjY0MzAgbWF0bHMpKFRlbnNpbGUgU3RyZW5ndGgsIFVsdGltYXRlICg2NjQzMCBtYXRscyklVGVuc2lsZSBTdHJlbmd0aCwgWWllbGQgKDQ2MjM4IG1hdGxzKSJUaGVybWFsIENvbmR1Y3Rpdml0eSAoMTY3NTUgbWF0bHMpIlRyYW5zbWlzc2lvbiwgVmlzaWJsZSAoNjM3NyBtYXRscykfVUwgUlRJLCBFbGVjdHJpY2FsICgzMjg3IG1hdGxzKStVTCBSVEksIE1lY2hhbmljYWwgd2l0aCBJbXBhY3QgKDI5ODkgbWF0bHMpLlVMIFJUSSwgTWVjaGFuaWNhbCB3aXRob3V0IEltcGFjdCAoMzAwMiBtYXRscykjVmljYXQgU29mdGVuaW5nIFBvaW50ICgxNzgzOSBtYXRscykeV2F0ZXIgQWJzb3JwdGlvbiAoMTg2MzYgbWF0bHMpIVdBVEVSIEFCU09SUFRJT04gW1BST1BFUlRZIEdST1VQXStXYXRlciBBYnNvcnB0aW9uIGF0IFNhdHVyYXRpb24gKDQyNjIgbWF0bHMpFXIBMAExATIBMwE1AjUxAzEyNgMxMjcDMTI4AzE1MwMxNTYDMTU5AzE2MQMxODIDMTgzAzE5NAMyMDkDMjEwAzIxMQMyMTIDMjE1AzIyNwMyMzADMjM4AzI0NgMyNTQIR1JPVVBfMTcDMjYzAzI2NQMyNjYDMjg4AzI5OQMzMDADMzAxAzMwMgMzMDMDMzA0AzMwNQMzMDYDMzExAzMxNAMzMTUDMzE3AzMyOQMzMzYDMzQyAzM0NAMzNDUDMzU0AzM1NQMzNTgDMzYyAzM2MwMzNjQDMzY1AzM3MQMzNzIDMzczAzM3NQMzODADMzgyAzM4NQMzODcDNDAwAzQzOQM0NDMDNDUwAzQ1OAM0NzIDNDc2AzQ5MAM0OTgDNDk5AzUwMQM1MDMDNTA0AzUxNwhHUk9VUF8xNQM1MTgDNTIyAzUyNQM1MjcDNTU5AzU2MQM1OTgDNjE5AzYyNwM2MjgDNjMyAzYzNQM2NDMIR1JPVVBfMTgDNjQ4AzY1MAM2ODgDNjk1AzcwNwhHUk9VUF8xNgM3MjAEMTEzMwM3MjkDNzM4Azc0MgM3NDMDNzQ1Azc1MQM3NjkDNzc3Azc3OAM3NzkDNzkzAzgwNwhHUk9VUF8xNAM4MDgUKwNyZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnFgECZ2QCAw8PFggfF2YfGALnBR8DAgEfBAIBZBYOZg8PFgIfGWhkFgQCAQ8PFgIfAAUTU2VsZWN0ZWQgUHJvcGVydHk6IGRkAgMPDxYCHwAFKFRlbnNpbGUgU3RyZW5ndGgsIFVsdGltYXRlICg2NjQzMCBtYXRscylkZAIEDxBkZBYAZAIIDxBkZBYAZAIKDxAPFgYfGgUHVU9NVGV4dB8bBQVVT01JRB8cZ2QQFQQKa2coZikvY23CsgNNUGEDcHNpA2tzaRUEAzE1NgMxMDgDMTIzAjc4FCsDBGdnZ2cWAQIBZAIMDw8WAh8ABX5NaW46IDxhIGhyZWY9ImphdmFzY3JpcHQ6bWF0d2ViLnNldEZpZWxkVmFsdWUoJ2N0bDAwX0NvbnRlbnRNYWluX3VjUHJvcGVydHlFZGl0Ml90eHRwTWluJywnMC4wMDAyNTAnKTsiPjAuMDAwMjUwPC9hPiBNUGEmbmJzcDtkZAIODw8WAh8ABXBNYXg6IDxhIGhyZWY9ImphdmFzY3JpcHQ6bWF0d2ViLnNldEZpZWxkVmFsdWUoJ2N0bDAwX0NvbnRlbnRNYWluX3VjUHJvcGVydHlFZGl0Ml90eHRwTWF4JywnNjg0MCcpOyI+Njg0MDwvYT4gTVBhZGQCEg9kFgQCAQ8QZBAVABUAFCsDABYAZAIDD2QWCgIBDw8WAh8ABQEwZGQCAw8PFgIfAGVkZAIFDxBkEBUAFQAUKwMAFgBkAgsPDxYCHxloZGQCDQ8QDxYCHx1oZGRkZAIND2QWAmYPZBYEAgEPZBYCZg8QD2QWAh8WBUlfX2RvUG9zdEJhY2soImN0bDAwX0NvbnRlbnRNYWluX3VjUHJvcGVydHlEcm9wZG93bjNfZHJwUHJvcGVydHlMaXN0IiwiIik7EBVyDiAtLSBzZWxlY3QgLS0gHTElIFNlY2FudCBNb2R1bHVzICg1NDYgbWF0bHMpIjElIFNlY2FudCBNb2R1bHVzLCBNRCAoMTk1MyBtYXRscykiMSUgU2VjYW50IE1vZHVsdXMsIFREICgxOTE3IG1hdGxzKR0yJSBTZWNhbnQgTW9kdWx1cyAoNTQ2IG1hdGxzKRtBcmMgUmVzaXN0YW5jZSAoMzI2OCBtYXRscykaQ2hhcnB5IEltcGFjdCAoMTA1NSBtYXRscyklQ2hhcnB5IEltcGFjdCBVbm5vdGNoZWQgKDExOTI1IG1hdGxzKSRDaGFycHkgSW1wYWN0LCBOb3RjaGVkICgxNjE4NiBtYXRscykkQ29lZmZpY2llbnQgb2YgRnJpY3Rpb24gKDM0ODAgbWF0bHMpJ0NvbXBhcmF0aXZlIFRyYWNraW5nIEluZGV4ICg5MDk2IG1hdGxzKSBDb21wcmVzc2l2ZSBNb2R1bHVzICgxODkyIG1hdGxzKSdDb21wcmVzc2l2ZSBZaWVsZCBTdHJlbmd0aCAoODYyMCBtYXRscykZQ1RFLCBsaW5lYXIgKDI5NDc2IG1hdGxzKSxDVEUsIGxpbmVhciwgVHJhbnN2ZXJzZSB0byBGbG93ICg3MDY0IG1hdGxzKRZDdXJlIFRpbWUgKDQxMTAgbWF0bHMpOURlZmxlY3Rpb24gVGVtcGVyYXR1cmUgYXQgMC40NiBNUGEgKDY2IHBzaSkgKDI0MTY5IG1hdGxzKTlEZWZsZWN0aW9uIFRlbXBlcmF0dXJlIGF0IDEuOCBNUGEgKDI2NCBwc2kpICgzNTc4NiBtYXRscykrRGVmbGVjdGlvbiBUZW1wZXJhdHVyZSBhdCA1LjAgTVBhICgwIG1hdGxzKS1EZWZsZWN0aW9uIFRlbXBlcmF0dXJlIGF0IDguMCBNUGEgKDg5NSBtYXRscykWRGVuc2l0eSAoMTA4MjI3IG1hdGxzKSFEaWVsZWN0cmljIENvbnN0YW50ICgxMzQ2MyBtYXRscykhRGllbGVjdHJpYyBTdHJlbmd0aCAoMTU5MjAgbWF0bHMpIERpc3NpcGF0aW9uIEZhY3RvciAoMTA2MDEgbWF0bHMpIERyeWluZyBUZW1wZXJhdHVyZSAoMTkzOTEgbWF0bHMpJEVsZWN0cmljYWwgUmVzaXN0aXZpdHkgKDMwNDQwIG1hdGxzKRtFTE9OR0FUSU9OIFtQUk9QRVJUWSBHUk9VUF0hRWxvbmdhdGlvbiBhdCBCcmVhayAoNzIzNDYgbWF0bHMpIUVsb25nYXRpb24gYXQgWWllbGQgKDE0NDUzIG1hdGxzKRxFbWlzc2l2aXR5ICgwLTEpICgxNjIgbWF0bHMpHUZhdGlndWUgU3RyZW5ndGggKDExNjYgbWF0bHMpKUZpbG0gRWxvbmdhdGlvbiBhdCBCcmVhaywgTUQgKDM2MDQgbWF0bHMpKUZpbG0gRWxvbmdhdGlvbiBhdCBCcmVhaywgVEQgKDMzNjEgbWF0bHMpKEZpbG0gRWxvbmdhdGlvbiBhdCBZaWVsZCwgTUQgKDI5OCBtYXRscykoRmlsbSBFbG9uZ2F0aW9uIGF0IFlpZWxkLCBURCAoMjU1IG1hdGxzKS9GaWxtIFRlbnNpbGUgU3RyZW5ndGggYXQgQnJlYWssIE1EICgzNzc1IG1hdGxzKS9GaWxtIFRlbnNpbGUgU3RyZW5ndGggYXQgQnJlYWssIFREICgzNTIyIG1hdGxzKS9GaWxtIFRlbnNpbGUgU3RyZW5ndGggYXQgWWllbGQsIE1EICgxNjU5IG1hdGxzKS9GaWxtIFRlbnNpbGUgU3RyZW5ndGggYXQgWWllbGQsIFREICgxNjMxIG1hdGxzKSBGbGFtbWFiaWxpdHksIFVMOTQgKDI1MzMyIG1hdGxzKR5GbGV4dXJhbCBNb2R1bHVzICg0NTkwMSBtYXRscykgRmxleHVyYWwgU3RpZmZuZXNzICg0NTkwMSBtYXRscyklRmxleHVyYWwgWWllbGQgU3RyZW5ndGggKDM3MzE4IG1hdGxzKR5GcmFjdHVyZSBUb3VnaG5lc3MgKDYwOCBtYXRscykbR2FyZG5lciBJbXBhY3QgKDE1NzggbWF0bHMpJkdsYXNzIFRyYW5zaXRpb24gVGVtcCwgVGcgKDU4NjQgbWF0bHMpEkdsb3NzICgzMTkwIG1hdGxzKRtHbG93IFdpcmUgVGVzdCAoMzk1OSBtYXRscykcSGFyZG5lc3MsIEJhcmNvbCAoNDk1IG1hdGxzKR5IYXJkbmVzcywgQnJpbmVsbCAoNDcyMSBtYXRscykcSGFyZG5lc3MsIEtub29wICgzMzc0IG1hdGxzKSBIYXJkbmVzcywgUm9ja3dlbGwgQSAoNjY3IG1hdGxzKSFIYXJkbmVzcywgUm9ja3dlbGwgQiAoNDE1NSBtYXRscykhSGFyZG5lc3MsIFJvY2t3ZWxsIEMgKDMyMTAgbWF0bHMpIEhhcmRuZXNzLCBSb2Nrd2VsbCBFICgzMjIgbWF0bHMpIUhhcmRuZXNzLCBSb2Nrd2VsbCBNICgzMTc1IG1hdGxzKSFIYXJkbmVzcywgUm9ja3dlbGwgUiAoOTQ4OSBtYXRscykfSGFyZG5lc3MsIFNob3JlIEEgKDE3MjA1IG1hdGxzKR9IYXJkbmVzcywgU2hvcmUgRCAoMTEwMTUgbWF0bHMpHkhhcmRuZXNzLCBWaWNrZXJzICg0MTA3IG1hdGxzKRFIYXplICg1MTA4IG1hdGxzKSdIZWF0IERpc3RvcnRpb24gVGVtcGVyYXR1cmUgKDM3NyBtYXRscykbSGVhdCBvZiBGdXNpb24gKDEwNzAgbWF0bHMpIkhvdCBCYWxsIFByZXNzdXJlIFRlc3QgKDg1NCBtYXRscykXSXpvZCBJbXBhY3QgKDY4OSBtYXRscykiSXpvZCBJbXBhY3QsIE5vdGNoZWQgKDI5NDU5IG1hdGxzKSRJem9kIEltcGFjdCwgVW5ub3RjaGVkICgxMDAxMiBtYXRscykbSyAod2VhcikgRmFjdG9yICg5NjEgbWF0bHMpI0xpbmVhciBNb2xkIFNocmlua2FnZSAoMzQ2OTYgbWF0bHMpFUxpcXVpZHVzICg1MTIxIG1hdGxzKSFNYWduZXRpYyBQZXJtZWFiaWxpdHkgKDg5OCBtYXRscykuTWF4aW11bSBTZXJ2aWNlIFRlbXBlcmF0dXJlLCBBaXIgKDIwMTc0IG1hdGxzKS5NYXhpbXVtIFNlcnZpY2UgVGVtcGVyYXR1cmUsIEluZXJ0ICgzNjAgbWF0bHMpF01lbHQgRmxvdyAoMzI3MjUgbWF0bHMpHk1lbHQgVGVtcGVyYXR1cmUgKDI3NTQyIG1hdGxzKRtNZWx0aW5nIFBvaW50ICgyNzIzMCBtYXRscykuTWluaW11bSBTZXJ2aWNlIFRlbXBlcmF0dXJlLCBBaXIgKDEwMDU4IG1hdGxzKRhNT0RVTFVTIFtQUk9QRVJUWSBHUk9VUF0jTW9kdWx1cyBvZiBFbGFzdGljaXR5ICg0MTI1MCBtYXRscykvTW9pc3R1cmUgQWJzb3JwdGlvbiBhdCBFcXVpbGlicml1bSAoOTkxMSBtYXRscyknTW9pc3R1cmUgVmFwb3IgVHJhbnNtaXNzaW9uICgzNDQgbWF0bHMpHk1vbGQgVGVtcGVyYXR1cmUgKDI1NTgzIG1hdGxzKRlPeHlnZW4gSW5kZXggKDUwNTAgbWF0bHMpH094eWdlbiBUcmFuc21pc3Npb24gKDU4NSBtYXRscykbUG9pc3NvbnMgUmF0aW8gKDc4ODMgbWF0bHMpJFByb2Nlc3NpbmcgVGVtcGVyYXR1cmUgKDExMzQzIG1hdGxzKTFSZWZsZWN0aW9uIENvZWZmaWNpZW50LCBWaXNpYmxlICgwLTEpICgyNjAgbWF0bHMpHVJlZnJhY3RpdmUgSW5kZXggKDQ3MDQgbWF0bHMpJ1JpbmcgJiBCYWxsIFNvZnRlbmluZyBQb2ludCAoNDMwIG1hdGxzKRtSdXB0dXJlIFN0cmVuZ3RoICgxOCBtYXRscykaU2VjYW50IE1vZHVsdXMgKDU0NiBtYXRscykkU0VSVklDRSBURU1QRVJBVFVSRSBbUFJPUEVSVFkgR1JPVVBdGlNoZWFyIE1vZHVsdXMgKDc3ODQgbWF0bHMpG1NoZWFyIFN0cmVuZ3RoICg0NzU3IG1hdGxzKRRTb2xpZHVzICg0ODU0IG1hdGxzKSNTcGVjaWZpYyBIZWF0IENhcGFjaXR5ICg5Nzc3IG1hdGxzKR9TdGlmZm5lc3MgTW9kdWx1cyAoNDU5MDEgbWF0bHMpGVNUUkVOR1RIIFtQUk9QRVJUWSBHUk9VUF0gU3VyZmFjZSBSZXNpc3RhbmNlICgxMjEyOCBtYXRscykaVGFjay1GcmVlIFRpbWUgKDUxMCBtYXRscykaVGVhciBTdHJlbmd0aCAoOTE1MSBtYXRs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BB8ABQVQcm9wOR8gaGRkAgMPDxYCHxloZGQCBQ8PFgIfGWhkZAIxD2QWBgIBDw8WBB8ABQZQcm9wMTAfIGhkZAIDDw8WAh8ZaGRkAgUPDxYCHxloZGQCNQ8PFgIfAAUEOTYwOGRkAjcPEGQQFQUBMQEyATMBNAE1FQUBMQEyATMBNAE1FCsDBWdnZ2dnFgFmZAI5Dw8WAh8ABQI0OWRkAjsPDxYIHwAFC1tQcmV2IFBhZ2VdHw0KTh8gaB8PAgRkZAI9Dw8WBh8ABQtbTmV4dCBQYWdlXR8NCiMfDwIEZGQCPw8QZGQWAQIFZAJBDxYCHxloFgICAQ8PFgIfAAW4BDxiciAvPg0KTWF0ZXJpYWxzIGZsYWdnZWQgYXMgZGlzY29udGludWVkICg8aW1nIHNyYz0iL2ltYWdlcy9idXR0b25zL2ljb25EaXNjb250aW51ZWQuanBnIiBhbHQ9IiIgLz4pIGFyZSBubyBsb25nZXIgcGFydCBvZiB0aGUgbWFudWZhY3R1cmVy4oCZcyBzdGFuZGFyZCBwcm9kdWN0IGxpbmUgYWNjb3JkaW5nIHRvIG91ciBsYXRlc3QgaW5mb3JtYXRpb24uICBUaGVzZSBtYXRlcmlhbHMgbWF5IGJlIGF2YWlsYWJsZSBieSBzcGVjaWFsIG9yZGVyLCBpbiBkaXN0cmlidXRpb24gaW52ZW50b3J5LCBvciByZWluc3RhdGVkIGFzIGFuIGFjdGl2ZSBwcm9kdWN0LiAgRGF0YSBzaGVldHMgZnJvbSBtYXRlcmlhbHMgdGhhdCBhcmUgbm8gbG9uZ2VyIGF2YWlsYWJsZSByZW1haW4gaW4gTWF0V2ViIHRvIGFzc2lzdCB1c2VycyBpbiBmaW5kaW5nIHJlcGxhY2VtZW50IG1hdGVyaWFscy4gIA0KPGJyIC8+PGJyIC8+DQpVc2VycyBvZiBvdXIgQWR2YW5jZWQgU2VhcmNoIChyZWdpc3RyYXRpb24gcmVxdWlyZWQpIG1heSBleGNsdWRlIGRpc2NvbnRpbnVlZCBtYXRlcmlhbHMgZnJvbSBzZWFyY2ggcmVzdWx0cy5kZAIWD2QWAmYPFgIfAAVwPGEgaHJlZj0iL2NsaWNrdGhyb3VnaC5hc3B4P2FkZGF0YWlkPTI3NyIgY2xhc3M9ImZvb3RsaW5rIj48c3BhbiBjbGFzcz0iZm9vdCI+VHJhZGUmbmJzcDtQdWJsaWNhdGlvbnM8L3NwYW4+PC9hPmQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgMFMmN0bDAwJENvbnRlbnRNYWluJHVjTWF0R3JvdXBUcmVlX0xPRENTMSRtc1RyZWVWaWV3BRtjdGwwMCRDb250ZW50TWFpbiRidG5TdWJtaXQFGmN0bDAwJENvbnRlbnRNYWluJGJ0bkNsZWFymiZ1tNUm6Aj4dBCFvPV3dNkI+gs=',
				'__VIEWSTATEGENERATOR': '42B37C8E',
				'ctl00$txtQuickText': '',
				'ctl00$ContentMain$ucModalPopup1$hndPopupControl': '',
				'ctl00$ContentMain$txtMatGroupID': '9',
				'ctl00$ContentMain$txtMatGroupText': 'Metal (17052 matls)',
				'ctl00$ContentMain$btnSubmit.x': '12',
				'ctl00$ContentMain$btnSubmit.y': '18',
				'ctl00$ContentMain$ucPropertyDropdown1$drpPropertyList': '263',
				'ctl00$ContentMain$ucPropertyEdit1$txtpMin': '0',
				'ctl00$ContentMain$ucPropertyEdit1$txtpMax': '',
				'ctl00$ContentMain$ucPropertyEdit1$dropPropUOMID': '137',
				'ctl00$ContentMain$ucPropertyDropdown2$drpPropertyList': '743',
				'ctl00$ContentMain$ucPropertyEdit2$txtpMin': '0',
				'ctl00$ContentMain$ucPropertyEdit2$txtpMax': '',
				'ctl00$ContentMain$ucPropertyEdit2$dropPropUOMID': '108',
				'ctl00$ContentMain$ucPropertyDropdown3$drpPropertyList': '745',
				'ctl00$ContentMain$ucPropertyEdit3$txtpMin': '0',
				'ctl00$ContentMain$ucPropertyEdit3$txtpMax': '',
				'ctl00$ContentMain$ucPropertyEdit3$dropPropUOMID': '108',
				'ctl00$ContentMain$UcSearchResults1$drpPageSelect1': '%s'%str(i),
				'ctl00$ContentMain$UcSearchResults1$drpPageSize1': '200',
				'ctl00$ContentMain$UcSearchResults1$drpFolderList': '0',
				'ctl00$ContentMain$UcSearchResults1$txtFolderMatCount': '0/0',
				'ctl00$ContentMain$UcSearchResults1$drpPageSelect2': '%s'%str(i),
				'ctl00$ContentMain$UcSearchResults1$drpPageSize2': '200'}
		
	
		res2 = requests.post(url=url2, headers=headers, data=data)
		html = etree.HTML(res2.text)
		lis = html.xpath('//table[@class="tabledataformat t_ablegrid"]/tr[position()>1]//td[3]/a')
		set_list =[]
		for li in lis:
			title = li.xpath('./text()')[0]
			url = 'http://www.matweb.com/' + li.xpath('./@href')[0]
			data_list.append((title, url))
			set_list.append(title)
		
		print('----------完成一页的抓取----------')
	print('----------------完成所有列表页的获取----开始抓取详情页----------')
	detaile_spider(data_list)
	
	
if __name__=='__main__':
	start_spider()